<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Für dich ❤️</title>
<style>
  :root{
    --pink:#ff6b9b;
    --pink-2:#ff85ad;
    --bg1:#ffe6f0;
    --card:#fff0f6;
    --accent:#d63384;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:"Poppins",sans-serif;
    background:linear-gradient(135deg,var(--bg1),#fff);
    color:var(--accent);
  }
  h1,h2,p{text-align:center;margin:0 0 .6rem}
  button{background:var(--pink);border:none;color:#fff;padding:.6rem 1rem;border-radius:24px;cursor:pointer;transition:.18s}
  button:hover{transform:scale(1.04);background:var(--pink-2)}
  .center{max-width:980px;margin:18px auto;padding:0 16px}
  .card{background:var(--card);border:2px solid #ffb6c1;border-radius:14px;padding:16px;box-shadow:0 6px 20px rgba(0,0,0,0.06);margin:12px auto}
  .gallery{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin:12px 0}
  .gallery img{width:320px;max-width:90vw;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.12);transition:.2s}
  .gallery img:hover{transform:scale(1.02)}
  #menuButton{position:fixed;right:18px;bottom:18px;width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:26px;background:var(--pink-2);box-shadow:0 8px 24px rgba(0,0,0,0.18);color:#fff;cursor:pointer;z-index:12000}
  #menuPanel{position:fixed;right:18px;bottom:90px;width:270px;border-radius:14px;padding:12px;display:none;background:var(--card);z-index:12000;border:2px solid #ffb6c1;box-shadow:0 8px 24px rgba(0,0,0,0.12)}
  #menuPanel.open{display:flex;flex-direction:column;gap:8px}
  #menuPanel .small{font-size:.95rem;padding:.6rem;border-radius:10px;background:#fff;border:1px solid #ffdfe8;text-align:center}
  #notesPanel{position:fixed;left:5%;right:5%;bottom:22px;height:270px;background:var(--card);border-radius:14px;padding:10px;display:none;z-index:11999;box-shadow:0 8px 30px rgba(0,0,0,0.12);border:2px solid #ffb6c1}
  #notesPanel.open{display:flex;flex-direction:column}
  #notesPanel textarea{flex:1;border-radius:10px;border:1px solid #ffb6c1;padding:10px;font-family:inherit}
  #authPanel input{padding:10px;border-radius:8px;border:1px solid #ffdfe8;font-size:1rem}
  .heart{position:fixed;z-index:11000;pointer-events:auto;user-select:none;will-change:transform,opacity}
  @media (max-width:600px){
    .gallery img{width:88vw}
    #menuPanel{right:6%;width:88%}
    #menuButton{right:6%}
    #notesPanel{left:4%;right:4%;height:220px}
  }
</style>
</head>
<body>
  <div class="center">
    <h1>💖 Für dich bububär 💖</h1>
    <p>Diese Seite ist für dich gemacht, weil ich dich ganz doll liebi 💞</p>

    <div class="card">
      <h2>💌 13 (or more) reasons why</h2>
      <p id="letterText">Ein Bruchteil der Gründe wieso ich dich liebe.</p>
      <button id="showReasonBtn">Zeig mir einen Grund 💕</button>
    </div>

    <div class="card" style="text-align:center">
      <h2>🗓️ Countdown bis wir uns sehi:</h2>
      <div id="countdown" style="font-size:1.05rem;margin-top:8px;color:#ff5c8d">...</div>
    </div>

    <div class="card">
      <h2>📸 Leos und Mios besten Bilder</h2>
      <div class="gallery"><img id="randomImage" src="" alt="Random Bild"></div>
      <div style="text-align:center"><button id="changeImageBtn">Bild wechseln 💕</button></div>
    </div>

    <div class="card" style="text-align:center">
      <h2>Bin ich der allertollste Freund auf dieser Welt? 💕</h2>
      <div style="margin-top:10px;display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
        <button id="yesBtn">Ja du geiler</button>
        <button id="noBtn">Nein!!!</button>
      </div>
    </div>

    <footer style="margin:18px 0;text-align:center;color:#888">Mit Liebe gemacht von justini bananini 💕</footer>
  </div>

  <button id="menuButton">💖</button>
  <div id="menuPanel">
    <div id="pillReminder" class="small">
      <div id="pillTitle">💊 Nimm die Pille grrrr!</div>
      <div id="pillCountdown" style="font-size:.95rem;color:#ff5c8d;margin-top:6px"></div>
      <div style="margin-top:8px"><button id="pillTakenBtn">Hab genommi 😇</button></div>
    </div>

    <div id="loveCounter" class="small">Liebe: 0 💖</div>
    <div style="display:flex;gap:8px">
      <button id="addHeartBtn" style="flex:1">Herz +1</button>
      <button id="openNotesBtn" style="flex:1">📝</button>
    </div>

    <button id="loveShopBtn" class="small">Love Shop 💕</button>
    <div id="authControls" style="margin-top:8px"></div>

    <div id="leaderboard" style="margin-top:6px">
      <h4 style="margin:6px 0;text-align:left;font-size:1rem">Leaderboard 💖</h4>
      <ol id="leaderboardList" style="padding-left:16px;margin:0 0 8px 0"></ol>
    </div>
  </div>

  <div id="notesPanel">
    <div style="display:flex;align-items:center;justify-content:space-between;padding:6px 8px">
      <h3 style="margin:0">Paladins Ideen 💡</h3>
      <button id="closeNotesBtn" style="background:#ffb6c1;color:#fff;padding:6px 10px;border-radius:10px">Schließen</button>
    </div>
    <textarea id="notesArea" placeholder="Schreib deine Ideen hier rein..."></textarea>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
  const firebaseConfig = {
    apiKey: "AIzaSyDJl-UVkVFCj-CfDiXcYBbVRoT9WpboXOs",
    authDomain: "nathalie-notizen-webseite.firebaseapp.com",
    projectId: "nathalie-notizen-webseite",
    storageBucket: "nathalie-notizen-webseite.firebasestorage.app",
    messagingSenderId: "627451220911",
    appId: "1:627451220911:web:63357b6799f075bacfd55a"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  const menuButton = document.getElementById("menuButton");
  const menuPanel = document.getElementById("menuPanel");
  const loveCounterEl = document.getElementById("loveCounter");
  const leaderboardList = document.getElementById("leaderboardList");
  const loveShopBtn = document.getElementById("loveShopBtn");
  const addHeartBtn = document.getElementById("addHeartBtn");
  const authControls = document.getElementById("authControls");
  const notesArea = document.getElementById("notesArea");
  const openNotesBtn = document.getElementById("openNotesBtn");
  const closeNotesBtn = document.getElementById("closeNotesBtn");
  const pillTitle = document.getElementById("pillTitle");
  const pillCountdown = document.getElementById("pillCountdown");
  const pillTakenBtn = document.getElementById("pillTakenBtn");
  const randomImage = document.getElementById("randomImage");
  const changeImageBtn = document.getElementById("changeImageBtn");

  let currentUser=null, lovePoints=0, heartIntervalId=null;
  let leaderboardUnsub=null;

  function setLoveDisplay(){ loveCounterEl.textContent=`Liebe: ${lovePoints} 💖`; }

  async function saveLoveToFirestore(){
    if(!currentUser) return;
    try{
      const ref=db.collection("users").doc(currentUser.uid);
      await ref.set({love:lovePoints},{merge:true});
      console.log("💾 Liebe gespeichert:",lovePoints);
    }catch(e){console.error("Fehler beim Speichern:",e);}
  }

  function renderAuthControls(user){
    authControls.innerHTML="";
    if(user){
      const div=document.createElement("div");
      div.style.display="flex";div.style.flexDirection="column";div.style.gap="6px";
      const who=document.createElement("div");
      who.textContent=`Angemeldet: ${user.email}`;
      const out=document.createElement("button");
      out.textContent="Abmelden";
      out.onclick=()=>auth.signOut();
      div.append(who,out);authControls.append(div);
    }else{
      const form=document.createElement("div");
      form.style.display="flex";form.style.flexDirection="column";form.style.gap="6px";
      const e=document.createElement("input");e.type="email";e.placeholder="E-Mail";
      const p=document.createElement("input");p.type="password";p.placeholder="Passwort";
      const inBtn=document.createElement("button");inBtn.textContent="Anmelden";
      inBtn.onclick=()=>auth.signInWithEmailAndPassword(e.value,p.value).catch(err=>alert(err.message));
      const upBtn=document.createElement("button");upBtn.textContent="Registrieren";
      upBtn.style.background="#ffd4e3";upBtn.style.color="#8a2b54";
      upBtn.onclick=()=>auth.createUserWithEmailAndPassword(e.value,p.value).catch(err=>alert(err.message));
      form.append(e,p,inBtn,upBtn);authControls.append(form);
    }
  }

  auth.onAuthStateChanged(async user=>{
    currentUser=user;
    renderAuthControls(user);
    if(user){
      const doc=await db.collection("users").doc(user.uid).get();
      lovePoints=(doc.exists&&doc.data().love)||0;
      setLoveDisplay();
      saveLoveToFirestore();
      startHeartRain();
      if(leaderboardUnsub) leaderboardUnsub();
      leaderboardUnsub=updateLeaderboardRealtime();
      const notesDoc=await db.collection("notes").doc(user.uid).get();
      notesArea.value=(notesDoc.exists&&notesDoc.data().text)||"";
    }else{
      lovePoints=0;setLoveDisplay();stopHeartRain();
      if(leaderboardUnsub) leaderboardUnsub();
      leaderboardList.innerHTML="<li>Bitte anmelden 💕</li>";
      notesArea.value="";
    }
  });

  function createHeart(){
    const h=document.createElement("div");
    h.className="heart";h.textContent="💖";
    const s=Math.floor(Math.random()*28)+16;
    h.style.fontSize=s+"px";h.style.left=Math.random()*(window.innerWidth-80)+20+"px";h.style.top="-40px";
    document.body.append(h);
    h.onclick=async e=>{
      e.stopPropagation();
      if(!currentUser){alert("Bitte anmelden 💕");return;}
      lovePoints++;setLoveDisplay();await saveLoveToFirestore();h.remove();
    };
    const endY=window.innerHeight+80,dur=Math.random()*3500+3000;let st=null;
    function anim(ts){
      if(!st)st=ts;
      const pr=(ts-st)/dur;
      const y=Math.min(pr*endY,endY);
      h.style.transform=`translateY(${y}px) rotate(${pr*360}deg)`;h.style.opacity=1-pr;
      pr<1?requestAnimationFrame(anim):h.remove();
    }
    requestAnimationFrame(anim);
  }
  function startHeartRain(){if(heartIntervalId)return;createHeart();heartIntervalId=setInterval(createHeart,900);}
  function stopHeartRain(){if(heartIntervalId){clearInterval(heartIntervalId);heartIntervalId=null;}document.querySelectorAll(".heart").forEach(h=>h.remove());}

  addHeartBtn.onclick=async()=>{if(!currentUser)return alert("Bitte anmelden 💕");lovePoints++;setLoveDisplay();await saveLoveToFirestore();};

  function updateLeaderboardRealtime(){
    return db.collection("users").where("love",">=",0).orderBy("love","desc").limit(5)
      .onSnapshot(snap=>{
        leaderboardList.innerHTML="";
        snap.forEach(doc=>{
          const d=doc.data();
          const name=doc.id===(currentUser&&currentUser.uid)?"Du":(d.displayName||doc.id.slice(0,6));
          const li=document.createElement("li");
          li.textContent=`${name}: ${d.love||0} 💖`;
          leaderboardList.append(li);
        });
        if(!leaderboardList.children.length)leaderboardList.innerHTML="<li>noch keiner 💕</li>";
      });
  }

  let notesTimer=null;
  notesArea.addEventListener("input",()=>{
    if(!currentUser)return;
    if(notesTimer)clearTimeout(notesTimer);
    notesTimer=setTimeout(()=>db.collection("notes").doc(currentUser.uid).set({text:notesArea.value}),700);
  });

  loveShopBtn.onclick=()=>{
    const shop=`<button id="b1">Mini Date - 10 💖</button><button id="b2">Ice Cream - 25 💖</button><button id="b3">Movie Date - 50 💖</button>`;
    const box=document.createElement("div");
    box.style=`position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:13000;padding:14px;border-radius:12px;background:#fff0f6;border:2px solid #ffb6c1;display:flex;flex-direction:column;gap:8px;`;
    box.innerHTML=shop;document.body.append(box);
    box.onclick=async e=>{
      const id=e.target.id;let cost=0,name="";
      if(id==="b1"){cost=10;name="Mini Date";}
      if(id==="b2"){cost=25;name="Ice Cream Date";}
      if(id==="b3"){cost=50;name="Movie Date";}
      if(cost){if(lovePoints>=cost){lovePoints-=cost;setLoveDisplay();await saveLoveToFirestore();alert(`Du hast ${name} gekauft 💕`);}else alert("Nicht genug Liebe 💖");box.remove();}
    };
    setTimeout(()=>window.addEventListener("click",function c(ev){if(!box.contains(ev.target)){box.remove();window.removeEventListener("click",c);}}),100);
  };

  function updatePillCountdown(){
    const now=new Date(),pill=new Date();pill.setHours(20,0,0,0);
    if(now>pill)pill.setDate(pill.getDate()+1);
    const diff=pill-now,h=Math.floor(diff/3600000),m=Math.floor((diff/60000)%60);
    const last=localStorage.getItem("pillTakenDate"),today=new Date().toDateString();
    if(last===today){pillTitle.textContent="✅ Schon genommi heute!";pillCountdown.textContent=`Nächste in ${h}h ${m}m 💗`;}
    else if(now.getHours()>=20){pillTitle.textContent="💊 Nimm die Pille ml!!!!";pillCountdown.textContent="Jetzt ist Zeit 💖";}
    else{pillTitle.textContent="Pille späti nehmi:";pillCountdown.textContent=`Noch ${h}h ${m}m 💞`;}
  }
  setInterval(updatePillCountdown,30000);updatePillCountdown();
  pillTakenBtn.onclick=()=>{localStorage.setItem("pillTakenDate",new Date().toDateString());updatePillCountdown();};

  menuButton.onclick=()=>menuPanel.classList.toggle("open");
  openNotesBtn.onclick=()=>{document.getElementById("notesPanel").style.display="flex";};
  closeNotesBtn.onclick=()=>{document.getElementById("notesPanel").style.display="none";};

  const reasons=["Du bist die erste Person, die ich immer bei mir will.","Du bist das erste, an das ich morgens denke.","Du hast so lange auf mich gewartet <3.","Du bist so süß und lieb.","Du machst mich einfach glücklich.","Du bist der Grund, warum ich lächle.","Ich liebe deine Art, wie du lachst.","Ich liebe dich, weil du mich verstehst.","Ich liebe es, dass du so wunderschön bist.","Ich liebe deine Stimme.","Ich liebe dein Lächeln.","Ich liebe dein Herz.","Ich liebe alles an dir."];
  const showReasonBtn=document.getElementById("showReasonBtn");
  showReasonBtn.onclick=()=>{document.getElementById("letterText").textContent=reasons[Math.floor(Math.random()*reasons.length)];};

  const targetDate=new Date("2025-11-20T18:00:00");
  const countdownEl=document.getElementById("countdown");
  function updateCountdown(){
    const now=new Date(),diff=targetDate-now;
    if(diff<=0){countdownEl.textContent="💖 Heute sehn wir uns!";return;}
    const d=Math.floor(diff/86400000),h=Math.floor((diff%86400000)/3600000),m=Math.floor((diff%3600000)/60000);
    countdownEl.textContent=`${d} Tage, ${h} Stunden, ${m} Minuten 💕`;
  }
  setInterval(updateCountdown,60000);updateCountdown();

  const pics=["https://i.imgur.com/TnM1Fnv.jpg","https://i.imgur.com/szIg3xP.jpg","https://i.imgur.com/4QqE0vD.jpg","https://i.imgur.com/aL5Dlke.jpg"];
  function randomPic(){randomImage.src=pics[Math.floor(Math.random()*pics.length)];}
  randomPic();changeImageBtn.onclick=randomPic;

  document.getElementById("yesBtn").onclick=()=>alert("Ich weiß 😎💖");
  document.getElementById("noBtn").onclick=()=>alert("Frechheit 😤💔");
  </script>
</body>
</html>
